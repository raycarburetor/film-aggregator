@tailwind base;
@tailwind components;
@tailwind utilities;

/* Theme variables */
:root {
  --bg: 0 0 0;         /* black */
  --fg: 255 255 255;   /* white */
  --muted: 160 160 160;/* muted text */
  --panel: 20 20 20;   /* panel bg */
  --stroke: 255 255 255; /* white stroke */
  --hover: 190 10 50;  /* darker crimson */
  --gold: 212 175 55;  /* gold (#D4AF37) */
  /* Hint browsers weâ€™re dark; improves controls/scrollbars on mobile */
  color-scheme: dark;
}

/* Base dark theme */
@layer base {
  html { scroll-behavior: smooth; }
  html, body {
    background: rgb(var(--bg));
    color: rgb(var(--fg));
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-weight: 200;
    -webkit-text-size-adjust: 100%; /* prevent iOS text auto-zoom */
    /* Reserve gutter to avoid layout shift when scrollbars appear/disappear */
    scrollbar-gutter: stable both-edges;
  }
  /* Square corners globally */
  * { border-radius: 0 !important; }
  /* Links inherit context color */
  ::selection { background: rgb(var(--stroke) / 0.35); color: rgb(var(--fg)); }

  /* Remove grey iOS tap highlight on common interactive elements */
  a, button, summary, input, select, textarea { -webkit-tap-highlight-color: transparent; }

  /* Form elements */
  input, select, textarea {
    background: rgb(var(--bg));
    color: rgb(var(--fg));
    border: 1px solid rgb(var(--stroke));
  }
  input::placeholder, textarea::placeholder { color: rgb(var(--muted)); }
  button { color: rgb(var(--fg)); }

  /* Focus visibility */
  :focus-visible { outline: 1px solid rgb(var(--stroke) / 0.6); outline-offset: 2px; }
}

/* Remove number input spinners (year fields) */
@layer base {
  /* Chrome, Safari, Edge, Opera */
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  /* Firefox */
  input[type="number"] {
    -moz-appearance: textfield;
    appearance: textfield;
  }
}

/* Accent stroke defaults for Tailwind border utilities used */
@layer utilities {
  .border, .border-t, .border-b, .border-l, .border-r {
    border-color: rgb(var(--stroke)) !important;
  }

  /* Dark equivalents + hover behavior */
  .bg-gray-50 { background-color: rgb(var(--panel)) !important; }
  .bg-gray-900 { background-color: rgb(0 0 0) !important; }
  .hover\:bg-gray-50:hover { background-color: rgb(var(--hover)) !important; color: rgb(var(--fg)) !important; }
  .hover\:bg-gray-50:hover td { background-color: rgb(var(--hover)) !important; color: rgb(var(--fg)) !important; }
  .hover\:bg-gray-50:hover td * { color: rgb(var(--fg)) !important; }
  .bg-gray-50\/60 { background-color: rgb(var(--panel) / 0.6) !important; }
  .text-gray-500 { color: rgb(var(--muted)) !important; }
  .text-gray-600 { color: rgb(200 200 200) !important; }
}

/* Accent-on-hover behavior for interactive elements */
@layer components {
  /* Ensure table-fixed columns include padding in width calc to avoid overflow */
  table.table-fixed th, table.table-fixed td { box-sizing: border-box; }
  /* Subtle mobile tap feedback + better touch behavior */
  .tappable { transition: transform 120ms ease, background-color 120ms ease, color 120ms ease, border-color 120ms ease; touch-action: manipulation; }
  @media (hover: none) and (pointer: coarse) {
    .tappable:active { transform: scale(0.98); }
    /* Prevent mobile tap-scale on top time tabs to avoid layout jiggle */
    .tab-btn:active { transform: none !important; }
    /* Suppress focus outlines on tap for selected rows/buttons to avoid white box on red */
    .no-focus-outline:focus,
    .no-focus-outline:focus-visible,
    tr.selected-row *:focus,
    tr.selected-row *:focus-visible { outline: none !important; }
  }
  @media (prefers-reduced-motion: reduce) {
    .tappable, summary.filters-summary .filters-arrow { transition: none !important; }
  }
  /* Minimum hit target utility (use sparingly) */
  .hit-44 { min-height: 44px; }

  /* removed column highlight utility */
  /* Selected row: force full white text and crimson bg */
  .selected-row,
  .selected-row td,
  .selected-row td * {
    background-color: rgb(var(--hover)) !important;
    color: rgb(var(--fg)) !important;
  }

  /* When hovering the summary row, also highlight the following details row */
  tr.peer:hover + tr.details-row,
  tr.peer:hover + tr.details-row td,
  tr.peer:hover + tr.details-row td * {
    background-color: rgb(var(--hover)) !important;
    color: rgb(var(--fg)) !important;
  }

  /* When selected, keep the details row highlighted */
  tr.selected-row + tr.details-row,
  tr.selected-row + tr.details-row td,
  tr.selected-row + tr.details-row td * {
    background-color: rgb(var(--hover)) !important;
    color: rgb(var(--fg)) !important;
  }

  /* Tabs: no borders; Chips: full white borders */
  .tab-btn { border: 0 !important; }
  .chip-btn { border: 1px solid rgb(var(--stroke)) !important; }
  .tab-btn:hover,
  .tab-btn[aria-selected="true"] {
    background-color: rgb(var(--hover)) !important;
    color: rgb(var(--fg)) !important;
    border: 0 !important;
  }
  .chip-btn.is-selected {
    background-color: rgb(var(--hover)) !important;
    color: rgb(var(--fg)) !important;
    border-color: transparent !important; /* hide border when active */
  }
  /* Limit chip hover highlight to pointer devices to avoid sticky red on touch */
  @media (hover: hover) and (pointer: fine) {
    .chip-btn:hover {
      background-color: rgb(var(--hover)) !important;
      color: rgb(var(--fg)) !important;
      border-color: transparent !important;
    }
  }

  /* Hide default summary marker for custom-styled Filters summary */
  summary.filters-summary::-webkit-details-marker { display: none; }
  summary.filters-summary::marker { content: ''; }

  /* Filters arrow direction: right when collapsed, down when expanded */
  summary.filters-summary .filters-arrow {
    transform: rotate(-90deg);
    transform-origin: center;
    transition: transform 150ms ease;
  }
  details[open] > summary.filters-summary .filters-arrow {
    transform: rotate(0deg);
  }

  /* Applied filters: only the border turns red */
  details.filters-details--applied { border-color: rgb(var(--hover)) !important; }

  /* Removed applied state styles; only arrow changes color when filters are set */

  /* Cinema filter checkboxes: custom style, no tick when selected */
  .cinema-checkbox {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    width: 1rem;
    height: 1rem;
    border: 1px solid rgb(var(--stroke));
    background: rgb(var(--bg));
    display: inline-grid;
    place-content: center;
  }
  /* Limit hover styling to non-touch devices to avoid sticky red after tap */
  @media (hover: hover) and (pointer: fine) {
    .cinema-checkbox:hover {
      border-color: rgb(var(--hover));
      background-color: rgb(var(--hover));
    }
  }
  .cinema-checkbox:checked {
    background-color: rgb(var(--hover));
    border-color: rgb(var(--hover));
  }

  /* Inputs: red border only when containing text (not on focus alone) */
  input:not([type]):not(:placeholder-shown),
  input[type="text"]:not(:placeholder-shown),
  input[type="search"]:not(:placeholder-shown),
  input[type="number"]:not(:placeholder-shown),
  textarea:not(:placeholder-shown) {
    border-color: rgb(var(--hover)) !important;
  }

  /* Inputs: remove extra outline to avoid double border when focused */
  input:not([type]):focus-visible,
  input[type="text"]:focus-visible,
  input[type="search"]:focus-visible,
  input[type="number"]:focus-visible,
  textarea:focus-visible,
  select:focus-visible { outline: none; }
}
